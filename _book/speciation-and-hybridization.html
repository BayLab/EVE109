<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 7 Speciation and Hybridization | EVE 109: Molecular Ecology</title>
  <meta name="description" content="Tutorials and datasets for discussion and homeowork excesises for EVE 109: Molecular Ecology" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 7 Speciation and Hybridization | EVE 109: Molecular Ecology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tutorials and datasets for discussion and homeowork excesises for EVE 109: Molecular Ecology" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 7 Speciation and Hybridization | EVE 109: Molecular Ecology" />
  
  <meta name="twitter:description" content="Tutorials and datasets for discussion and homeowork excesises for EVE 109: Molecular Ecology" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="project-time.html"/>
<link rel="next" href="veterans-day.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EVE109 FQ21</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#tour-of-rstudio"><i class="fa fa-check"></i><b>1.2</b> Tour of RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#basic-functions-in-r"><i class="fa fa-check"></i><b>1.4</b> Basic functions in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#exercise-write-a-script-to-find-out-what-fraction-of-your-life-youve-been-at-uc-davis"><i class="fa fa-check"></i><b>1.4.1</b> <em>Exercise</em>: Write a script to find out what fraction of your life you’ve been at UC Davis</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#classes"><i class="fa fa-check"></i><b>1.5</b> Classes</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#vectors-and-dataframes"><i class="fa fa-check"></i><b>1.6</b> Vectors and dataframes</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#subsetting"><i class="fa fa-check"></i><b>1.7</b> Subsetting</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#plotting"><i class="fa fa-check"></i><b>1.8</b> Plotting</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#exercise-describe-this-plot-in-plain-english.-what-conclusions-can-we-draw"><i class="fa fa-check"></i><b>1.8.1</b> <em>Exercise</em>: Describe this plot in plain english. What conclusions can we draw?</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#homework"><i class="fa fa-check"></i><b>1.9</b> Homework</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#homework-1-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>1.9.1</b> <em>Homework 1: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="molecular-markers.html"><a href="molecular-markers.html"><i class="fa fa-check"></i><b>2</b> Molecular Markers</a>
<ul>
<li class="chapter" data-level="2.1" data-path="molecular-markers.html"><a href="molecular-markers.html#paths"><i class="fa fa-check"></i><b>2.1</b> Paths</a></li>
<li class="chapter" data-level="2.2" data-path="molecular-markers.html"><a href="molecular-markers.html#reading-in-data-from-spreadsheets"><i class="fa fa-check"></i><b>2.2</b> Reading in data from spreadsheets</a></li>
<li class="chapter" data-level="2.3" data-path="molecular-markers.html"><a href="molecular-markers.html#simple-capture-recapture-example"><i class="fa fa-check"></i><b>2.3</b> Simple capture recapture example</a></li>
<li class="chapter" data-level="2.4" data-path="molecular-markers.html"><a href="molecular-markers.html#homework-1"><i class="fa fa-check"></i><b>2.4</b> Homework</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="molecular-markers.html"><a href="molecular-markers.html#homework-2-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>2.4.1</b> <em>Homework 2: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="genetic-diversity.html"><a href="genetic-diversity.html"><i class="fa fa-check"></i><b>3</b> Genetic Diversity</a>
<ul>
<li class="chapter" data-level="3.1" data-path="genetic-diversity.html"><a href="genetic-diversity.html#manipulating-dataframes"><i class="fa fa-check"></i><b>3.1</b> Manipulating dataframes</a></li>
<li class="chapter" data-level="3.2" data-path="genetic-diversity.html"><a href="genetic-diversity.html#using-the-adegenet-package-to-calulate-heterozygosity"><i class="fa fa-check"></i><b>3.2</b> Using the <strong>adegenet</strong> package to calulate heterozygosity</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="genetic-diversity.html"><a href="genetic-diversity.html#plotting-heterozygosity"><i class="fa fa-check"></i><b>3.2.1</b> Plotting heterozygosity</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="genetic-diversity.html"><a href="genetic-diversity.html#homework-2"><i class="fa fa-check"></i><b>3.3</b> Homework</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="genetic-diversity.html"><a href="genetic-diversity.html#homework-3-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>3.3.1</b> <em>Homework 3: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="population-structure.html"><a href="population-structure.html"><i class="fa fa-check"></i><b>4</b> Population Structure</a>
<ul>
<li class="chapter" data-level="4.1" data-path="population-structure.html"><a href="population-structure.html#the-aggregate-and-apply-functions"><i class="fa fa-check"></i><b>4.1</b> The <code>aggregate</code> and <code>apply</code> functions</a></li>
<li class="chapter" data-level="4.2" data-path="population-structure.html"><a href="population-structure.html#running-a-clustering-analysis-and-deciding-on-a-k-value"><i class="fa fa-check"></i><b>4.2</b> Running a clustering analysis and deciding on a K value</a></li>
<li class="chapter" data-level="4.3" data-path="population-structure.html"><a href="population-structure.html#the-q-matrix"><i class="fa fa-check"></i><b>4.3</b> The Q matrix</a></li>
<li class="chapter" data-level="4.4" data-path="population-structure.html"><a href="population-structure.html#plotting-1"><i class="fa fa-check"></i><b>4.4</b> Plotting</a></li>
<li class="chapter" data-level="4.5" data-path="population-structure.html"><a href="population-structure.html#homework-3"><i class="fa fa-check"></i><b>4.5</b> Homework</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="population-structure.html"><a href="population-structure.html#homework-4-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>4.5.1</b> <em>Homework 4: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="haplotype-networks.html"><a href="haplotype-networks.html"><i class="fa fa-check"></i><b>5</b> Haplotype networks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="haplotype-networks.html"><a href="haplotype-networks.html#indexing"><i class="fa fa-check"></i><b>5.1</b> Indexing</a></li>
<li class="chapter" data-level="5.2" data-path="haplotype-networks.html"><a href="haplotype-networks.html#using-table-to-count-across-multiple-columns"><i class="fa fa-check"></i><b>5.2</b> Using <code>table</code> to count across multiple columns</a></li>
<li class="chapter" data-level="5.3" data-path="haplotype-networks.html"><a href="haplotype-networks.html#creating-a-haplotype-network"><i class="fa fa-check"></i><b>5.3</b> Creating a haplotype network</a></li>
<li class="chapter" data-level="5.4" data-path="haplotype-networks.html"><a href="haplotype-networks.html#homework-4"><i class="fa fa-check"></i><b>5.4</b> Homework</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="haplotype-networks.html"><a href="haplotype-networks.html#homework-5-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>5.4.1</b> <em>Homework 5: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="project-time.html"><a href="project-time.html"><i class="fa fa-check"></i><b>6</b> Project Time!</a></li>
<li class="chapter" data-level="7" data-path="speciation-and-hybridization.html"><a href="speciation-and-hybridization.html"><i class="fa fa-check"></i><b>7</b> Speciation and Hybridization</a>
<ul>
<li class="chapter" data-level="7.1" data-path="speciation-and-hybridization.html"><a href="speciation-and-hybridization.html#match"><i class="fa fa-check"></i><b>7.1</b> Match</a></li>
<li class="chapter" data-level="7.2" data-path="speciation-and-hybridization.html"><a href="speciation-and-hybridization.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>7.2</b> Dealing with missing data</a></li>
<li class="chapter" data-level="7.3" data-path="speciation-and-hybridization.html"><a href="speciation-and-hybridization.html#writing-your-own-functions"><i class="fa fa-check"></i><b>7.3</b> Writing your own functions</a></li>
<li class="chapter" data-level="7.4" data-path="speciation-and-hybridization.html"><a href="speciation-and-hybridization.html#hybrid-allele-frequencies"><i class="fa fa-check"></i><b>7.4</b> Hybrid allele frequencies</a></li>
<li class="chapter" data-level="7.5" data-path="speciation-and-hybridization.html"><a href="speciation-and-hybridization.html#making-a-pca"><i class="fa fa-check"></i><b>7.5</b> Making a PCA</a></li>
<li class="chapter" data-level="7.6" data-path="speciation-and-hybridization.html"><a href="speciation-and-hybridization.html#homework-5"><i class="fa fa-check"></i><b>7.6</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="veterans-day.html"><a href="veterans-day.html"><i class="fa fa-check"></i><b>8</b> Veteran’s Day</a></li>
<li class="chapter" data-level="9" data-path="veterans-day-1.html"><a href="veterans-day-1.html"><i class="fa fa-check"></i><b>9</b> Veteran’s Day</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EVE 109: Molecular Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="speciation-and-hybridization" class="section level1" number="7">
<h1><span class="header-section-number">Week 7</span> Speciation and Hybridization</h1>
<div id="match" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Match</h2>
<p>First of all, great news - no packages to install today!! The first command we’ll learn is <code>match</code>. <code>match</code> helps you match up two vectors that have the same values (or subset of values). For example, so far I’ve always given you metadata in the same order as your genotype files. But what if I didnt? We can use <code>match</code> to reorder the metadata so that it matches the genotype dataframe. Here’s how it works. First, let’s make two vectors with roughly the same values in different orders.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="speciation-and-hybridization.html#cb1-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FOX&quot;</span>,<span class="st">&quot;BEAR&quot;</span>,<span class="st">&quot;DOG&quot;</span>,<span class="st">&quot;CAT&quot;</span>,<span class="st">&quot;MOUSE&quot;</span>)</span>
<span id="cb1-2"><a href="speciation-and-hybridization.html#cb1-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BEAR&quot;</span>,<span class="st">&quot;CAT&quot;</span>,<span class="st">&quot;MOUSE&quot;</span>,<span class="st">&quot;FOX&quot;</span>,<span class="st">&quot;DOG&quot;</span>)</span>
<span id="cb1-3"><a href="speciation-and-hybridization.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(A,B)</span></code></pre></div>
<pre><code>## [1] 4 1 5 2 3</code></pre>
<p><code>match</code> looks at each value in the first vector and returns the <em>index</em> of that value in the second vector. Note that the order matters:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="speciation-and-hybridization.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">match</span>(B,A)</span></code></pre></div>
<pre><code>## [1] 2 4 5 1 3</code></pre>
<p>We can then use match to reorder the vectors to match:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="speciation-and-hybridization.html#cb5-1" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> B[<span class="fu">match</span>(A,B)]</span>
<span id="cb5-2"><a href="speciation-and-hybridization.html#cb5-2" aria-hidden="true" tabindex="-1"></a>C</span></code></pre></div>
<pre><code>## [1] &quot;FOX&quot;   &quot;BEAR&quot;  &quot;DOG&quot;   &quot;CAT&quot;   &quot;MOUSE&quot;</code></pre>
<p>So here we’ve taken the <code>B</code> vector and reordered it to match A.</p>
<p> 
 
 </p>
</div>
<div id="dealing-with-missing-data" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Dealing with missing data</h2>
<p>Sometimes data aren’t perfect. Sometimes we have missing values. How do we deal with them, or at least find them? Let’s look at he <code>airquality</code> example dataset:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="speciation-and-hybridization.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;airquality&quot;</span>)</span>
<span id="cb7-2"><a href="speciation-and-hybridization.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 5    NA      NA 14.3   56     5   5
## 6    28      NA 14.9   66     5   6</code></pre>
<p>Notice that there are several <strong>NA</strong> values. The first thing we might want to do is to identify all rows that have <strong>NA</strong> values. We can identify rows with missing data in a particular column using the <code>is.na</code> function:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="speciation-and-hybridization.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(airquality<span class="sc">$</span>Ozone)</span></code></pre></div>
<pre><code>##   [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE
##  [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [25]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [37]  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE FALSE FALSE
##  [49] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [61]  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
##  [73] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE
##  [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [97] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE
## [109] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE
## [121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [145] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</code></pre>
<p>We can then ask for the indexes of those “TRUE” values and subset the data with those indexes:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="speciation-and-hybridization.html#cb11-1" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">is.na</span>(airquality<span class="sc">$</span>Ozone)</span>
<span id="cb11-2"><a href="speciation-and-hybridization.html#cb11-2" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> airquality[ind,]</span>
<span id="cb11-3"><a href="speciation-and-hybridization.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub)</span></code></pre></div>
<pre><code>##    Ozone Solar.R Wind Temp Month Day
## 5     NA      NA 14.3   56     5   5
## 10    NA     194  8.6   69     5  10
## 25    NA      66 16.6   57     5  25
## 26    NA     266 14.9   58     5  26
## 27    NA      NA  8.0   57     5  27
## 32    NA     286  8.6   78     6   1</code></pre>
<p>More likely, though, we’ll want to want a subset <em>without</em> missing data. We can get this using <code>!</code> which, in programming languages often makes a function the opposite meaning. So, <code>!is.na</code> helps us find entries that do not have missing data:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="speciation-and-hybridization.html#cb13-1" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(airquality<span class="sc">$</span>Ozone)</span>
<span id="cb13-2"><a href="speciation-and-hybridization.html#cb13-2" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> airquality[ind,]</span>
<span id="cb13-3"><a href="speciation-and-hybridization.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub)</span></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 6    28      NA 14.9   66     5   6
## 7    23     299  8.6   65     5   7</code></pre>
<p>What if we want to look at missing data across the entire dataframe? First, we can use the function <code>complete.cases</code> to ask which rows have no missing data. We can also use the <code>which</code> function to ask for the indexes of those rows. These indexes could be used to subset the dataframe into only complete rows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="speciation-and-hybridization.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">complete.cases</span>(airquality)</span></code></pre></div>
<pre><code>##   [1]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE
##  [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [25] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
##  [37] FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE
##  [49]  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [61] FALSE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
##  [73]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE
##  [85]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
##  [97] FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
## [109]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE
## [121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [145]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="speciation-and-hybridization.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">complete.cases</span>(airquality))</span></code></pre></div>
<pre><code>##   [1]   1   2   3   4   7   8   9  12  13  14  15  16  17  18  19  20  21  22
##  [19]  23  24  28  29  30  31  38  40  41  44  47  48  49  50  51  62  63  64
##  [37]  66  67  68  69  70  71  73  74  76  77  78  79  80  81  82  85  86  87
##  [55]  88  89  90  91  92  93  94  95  99 100 101 104 105 106 108 109 110 111
##  [73] 112 113 114 116 117 118 120 121 122 123 124 125 126 127 128 129 130 131
##  [91] 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149
## [109] 151 152 153</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="speciation-and-hybridization.html#cb19-1" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> airquality[<span class="fu">which</span>(<span class="fu">complete.cases</span>(airquality)),]</span>
<span id="cb19-2"><a href="speciation-and-hybridization.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub)</span></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 7    23     299  8.6   65     5   7
## 8    19      99 13.8   59     5   8</code></pre>
<p>This is useful if you need the indexes to work across multiple dataframes (more on that later). But, if you just want to remove rows with missing data, you can just us <code>na.omit</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="speciation-and-hybridization.html#cb21-1" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(airquality)</span>
<span id="cb21-2"><a href="speciation-and-hybridization.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sub)</span></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 7    23     299  8.6   65     5   7
## 8    19      99 13.8   59     5   8</code></pre>
<p>Finally, some functions will not automatically work if you have missing data. For example, look what happens when you try to fine the mean Ozone value across the dataset:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="speciation-and-hybridization.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(airquality<span class="sc">$</span>Ozone)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>We need to tell the function what to do with NA values. The easiest thing to do is just ignore them:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="speciation-and-hybridization.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(airquality<span class="sc">$</span>Ozone,<span class="at">na.rm=</span>T)</span></code></pre></div>
<pre><code>## [1] 42.12931</code></pre>
<p> 
 
 </p>
</div>
<div id="writing-your-own-functions" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Writing your own functions</h2>
<p>So far, we’ve used a bunch of different functions that are provided by either the basic installation of R or various packages. But you can also write your own!</p>
<p>Let’s say we are interested in a very specific metric calculated as follows: (mean of all values)/(number of non-missing datapoints) 
We want to calculate this for each row. We know that we can do row by row calculations using the <code>apply</code> function, but how do we put this weird function into <code>apply</code>? First, we need to define our own function. This is how we do that:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="speciation-and-hybridization.html#cb27-1" aria-hidden="true" tabindex="-1"></a>ourfunction <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb27-2"><a href="speciation-and-hybridization.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  top <span class="ot">&lt;-</span> <span class="fu">mean</span>(x,<span class="at">na.rm=</span>T)</span>
<span id="cb27-3"><a href="speciation-and-hybridization.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  bottom <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="sc">!</span><span class="fu">is.na</span>(x))</span>
<span id="cb27-4"><a href="speciation-and-hybridization.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  metric <span class="ot">&lt;-</span> top<span class="sc">/</span>bottom</span>
<span id="cb27-5"><a href="speciation-and-hybridization.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(top)</span>
<span id="cb27-6"><a href="speciation-and-hybridization.html#cb27-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here we can think of <code>x</code> as each row that will be passed through the function. At the end of the function we use <code>return</code> to tell the function what value we want to get out. We could apply this to any set of numbers:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="speciation-and-hybridization.html#cb28-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">54</span>,<span class="dv">72</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb28-2"><a href="speciation-and-hybridization.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ourfunction</span>(a)</span></code></pre></div>
<pre><code>## [1] 22.66667</code></pre>
<p>Or we can apply our new function to each row in the dataframe:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="speciation-and-hybridization.html#cb30-1" aria-hidden="true" tabindex="-1"></a>ourmetric <span class="ot">&lt;-</span> <span class="fu">apply</span>(airquality,<span class="at">MARGIN=</span><span class="dv">1</span>,ourfunction)</span>
<span id="cb30-2"><a href="speciation-and-hybridization.html#cb30-2" aria-hidden="true" tabindex="-1"></a>ourmetric</span></code></pre></div>
<pre><code>##   [1] 51.90000 40.16667 42.60000 68.91667 20.07500 23.98000 67.93333 33.96667
##   [9] 20.35000 57.32000 20.78000 61.28333 65.70000 64.31667 29.03333 74.08333
##  [17] 73.50000 30.40000 75.91667 25.28333 17.28333 74.60000 21.28333 37.66667
##  [25] 33.92000 73.98000 24.25000 24.66667 71.15000 76.28333 72.56667 75.92000
##  [33] 75.74000 66.82000 57.84000 64.92000 73.86000 43.45000 76.18000 80.13333
##  [41] 79.41667 75.98000 73.84000 46.66667 89.16000 86.70000 54.31667 72.78333
##  [49] 25.86667 40.25000 43.71667 52.06000 32.94000 40.12000 72.46000 49.80000
##  [57] 49.00000 32.66000 44.70000 31.58000 53.00000 83.35000 66.70000 61.36667
##  [65] 41.38000 56.43333 76.81667 76.68333 79.55000 80.45000 62.23333 49.52000
##  [73] 63.38333 52.98333 83.58000 28.55000 69.81667 70.88333 76.88333 64.01667
##  [81] 67.75000 21.98333 75.54000 83.70000 83.26667 76.00000 37.43333 44.33333
##  [89] 70.90000 75.73333 74.06667 73.53333 36.48333 22.96667 32.23333 36.58000
##  [97] 28.08000 34.32000 80.83333 72.38333 72.00000 68.12000 50.70000 58.91667
## [105] 69.25000 55.61667 35.50000 34.05000 36.71667 41.23333 65.15000 58.38333
## [113] 66.91667 26.88333 74.72000 62.95000 87.23333 69.33333 56.34000 70.28333
## [121] 79.38333 76.88333 68.71667 61.81667 63.85000 60.63333 65.10000 41.73333
## [129] 39.75000 63.15000 58.05000 59.15000 64.11667 65.98333 65.41667 61.88333
## [137] 22.98333 38.58333 65.48333 58.13333 25.55000 61.38333 56.00000 59.60000
## [145] 24.70000 49.71667 28.05000 24.60000 55.81667 54.24000 55.21667 45.16667
## [153] 60.25000</code></pre>
</div>
<div id="hybrid-allele-frequencies" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Hybrid allele frequencies</h2>
<p>Today we’ll be looking at the data from Lamer et al. (2015). There are two files, a <a href="data/lamar_genotypes.csv">genotype table</a> and <a href="data/lamar_metadata.csv">metadata</a>. Let’s first read in the genotype table:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="speciation-and-hybridization.html#cb32-1" aria-hidden="true" tabindex="-1"></a>genofile <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/lamar_genotypes.csv&quot;</span>)</span>
<span id="cb32-2"><a href="speciation-and-hybridization.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(genofile)</span></code></pre></div>
<pre><code>##       ID snp1 snp2 snp3 snp4 snp5 snp6 snp7 snp8 snp9 snp10 snp11 snp12 snp13
## 1 ILAG 1    0    0    0    0    0    0    0    0    0     0     0     0     0
## 2 ILAG 2    0    0    1    0    0    0    0    0    0     0     0     0     0
## 3 ILAG 3    0    0    0    0    0    0    0    0    0     0     0     0     0
## 4 ILAG 4    0    0    1    0    0    0    0    0    0     0     0     0     0
## 5 ILAG 5    0    0    0    0    0    0    0    0    0     0     0     0     0
## 6 ILAG 6    0    0    0    0    0    0    0    0    0     0     0     0     0
##   snp14 snp15 snp16 snp17 snp18 snp19 snp20 snp21 snp22 snp23 snp24 snp25 snp26
## 1    NA     0     0     0     0     0     0     0     0     0     0     0     0
## 2     0     0     0     0     0     0     0     0     0     0     0     0    NA
## 3     0     0     0     0     0     0     0     0     0     0     0     0     0
## 4     0     0     0     0     0     0     0     0     0     0     0     0     0
## 5    NA     0     0     0     0     0     0     0     0    NA    NA    NA    NA
## 6     0     0     0     0     0     0     0     0     0    NA    NA    NA    NA
##   snp27 snp28 snp29 snp30 snp31 snp32 snp33 snp34 snp35 snp36 snp37 snp38 snp39
## 1     0     0     0     0     0     0     0     0     0     0     0     0     0
## 2     0     0     0     0     0     0     0     0     0     0    NA     0     0
## 3     0     0     0     0     0     1     0     0     0     0     0     0     0
## 4     0     0     0     0     0     0     0     0     0     0     0     0     0
## 5    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
## 6    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
##   snp40 snp41 snp42 snp43 snp44 snp45 snp46 snp47 snp48 snp49 snp50 snp51 snp52
## 1     0     0     0     0     0     0     0     0     0     0     0     0     0
## 2     0     0     0     0     0     0     0     0     0     0     0     0     0
## 3     0     1     0     0     0     0     0     0     0     0     0     0     0
## 4     0     0     0     0     0     0     0     0     0     0     0     0     0
## 5    NA    NA    NA    NA    NA     0     0     0     1     0     0     0     0
## 6    NA    NA    NA    NA    NA     0     0     0     0     0     0     0     0
##   snp53 snp54 snp55 snp56 snp57
## 1     0     0     0     0     0
## 2     0     0     0     0     0
## 3     0     0     0     0     0
## 4     0     0     0     0     0
## 5     0     0     0     0     0
## 6     0     0     0     0     0</code></pre>
<p>Here the first column is a sample ID. The rest of the columns are genotypes at diagnostic SNPs that distinguish between the two carp species in the paper. Values are 0, 1, or 2 and indicate the number of bighead carp alleles at that SNP. So, for example, a 2 means that individual is homozygous for the bighead carp allele while a 0 means that individual is homozygous for the silver carp allele. Let’s split the dataframe into the sample IDs and a frame with just the genotypes:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="speciation-and-hybridization.html#cb34-1" aria-hidden="true" tabindex="-1"></a>IDs <span class="ot">&lt;-</span> genofile[,<span class="dv">1</span>]</span>
<span id="cb34-2"><a href="speciation-and-hybridization.html#cb34-2" aria-hidden="true" tabindex="-1"></a>genos <span class="ot">&lt;-</span> genofile[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(genofile)]</span></code></pre></div>
<p>Now let’s read in the metadata:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="speciation-and-hybridization.html#cb35-1" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/lamar_metadata.csv&quot;</span>,<span class="at">stringsAsFactors =</span> T)</span>
<span id="cb35-2"><a href="speciation-and-hybridization.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meta)</span></code></pre></div>
<pre><code>##         ID          Reach    River Genetic.ID Field.ID Length Weight Age
## 1 ILAG 566 LaGrange Reach Illinois      Bx4SV     &lt;NA&gt;     NA     NA  NA
## 2 ILAG 567 LaGrange Reach Illinois      Bx4SV     &lt;NA&gt;     NA     NA  NA
## 3 ILAG 568 LaGrange Reach Illinois      Bx4SV     &lt;NA&gt;     NA     NA  NA
## 4 ILAG 569 LaGrange Reach Illinois         SV     &lt;NA&gt;     NA     NA  NA
## 5 ILAG 570 LaGrange Reach Illinois         SV     &lt;NA&gt;     NA     NA  NA
## 6 ILAG 571 LaGrange Reach Illinois         SV     &lt;NA&gt;     NA     NA  NA
##   Birth.year
## 1         NA
## 2         NA
## 3         NA
## 4         NA
## 5         NA
## 6         NA</code></pre>
<p>Notice that the metadata and the genotypes are <em>not</em> in the same order. We’ll use match like we did above to reorder the metadata:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="speciation-and-hybridization.html#cb37-1" aria-hidden="true" tabindex="-1"></a>ordermeta <span class="ot">&lt;-</span> meta[<span class="fu">match</span>(IDs,meta<span class="sc">$</span>ID),]</span></code></pre></div>
<p>Now that the genotype and metadata are aligned, we can do lots of different calculations. Maybe we want to calculate the fraction of bighead carp alleles for each individual. We can write a function for that:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="speciation-and-hybridization.html#cb38-1" aria-hidden="true" tabindex="-1"></a>allelefreq <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-2"><a href="speciation-and-hybridization.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  length <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">na.omit</span>(x))</span>
<span id="cb38-3"><a href="speciation-and-hybridization.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(x, <span class="at">na.rm=</span>T)</span>
<span id="cb38-4"><a href="speciation-and-hybridization.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  freq <span class="ot">&lt;-</span> sum<span class="sc">/</span>(length<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb38-5"><a href="speciation-and-hybridization.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(freq)</span>
<span id="cb38-6"><a href="speciation-and-hybridization.html#cb38-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The first line of the function calculates the length of the vector (the number of loci at which an individual is genotyped) - notice that we have omitted missing data. The second line simply adds the genotypes. We can do this because we know that hetorozygous individuals are coded as 1 and homozygous bighead carp individuals are coded as 2. The third row calculates the frequency of bighead carp alleles. Why do we have to multiple length by 2? Now we can apply that function to our genotype data:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="speciation-and-hybridization.html#cb39-1" aria-hidden="true" tabindex="-1"></a>bigAlleles <span class="ot">&lt;-</span> <span class="fu">apply</span>(genos,<span class="dv">1</span>,allelefreq)</span>
<span id="cb39-2"><a href="speciation-and-hybridization.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bigAlleles)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## 0.00000 0.00000 0.01754 0.31639 0.99029 1.00000</code></pre>
<p>Now we can do things like look at the mean frequency across different species classes (how accurate were our field IDs) or rivers (which river has the most introduced alleles?):</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="speciation-and-hybridization.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(bigAlleles,<span class="fu">list</span>(ordermeta<span class="sc">$</span>Field.ID),mean)</span></code></pre></div>
<pre><code>##   Group.1          x
## 1    BHCP 0.98366800
## 2  Hybrid 0.76778692
## 3    SVCP 0.02400816
## 4    UNKN 0.28485652</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="speciation-and-hybridization.html#cb43-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(bigAlleles,<span class="fu">list</span>(ordermeta<span class="sc">$</span>River),mean)</span></code></pre></div>
<p> 
 
 </p>
</div>
<div id="making-a-pca" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Making a PCA</h2>
<p>Now we want to make a PCA to visualize the similarity between individuals. We can do this with the <code>prcomp</code> function, but this function doesn’t like missing data. There are some ways to deal with missing genotypes without having to discard them, but since we have a lot of data we will just remove individuals that have any missing data for now. We also have to subset the metadata to match:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="speciation-and-hybridization.html#cb44-1" aria-hidden="true" tabindex="-1"></a>subgen <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(genos)</span>
<span id="cb44-2"><a href="speciation-and-hybridization.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subgen)</span></code></pre></div>
<pre><code>##    snp1 snp2 snp3 snp4 snp5 snp6 snp7 snp8 snp9 snp10 snp11 snp12 snp13 snp14
## 3     0    0    0    0    0    0    0    0    0     0     0     0     0     0
## 4     0    0    1    0    0    0    0    0    0     0     0     0     0     0
## 19    0    0    0    0    0    0    0    0    0     0     0     0     0     0
## 25    0    0    0    0    0    0    0    0    0     0     0     0     0     0
## 26    0    0    0    0    0    0    0    0    0     0     0     0     0     0
## 27    0    0    0    0    0    0    0    0    0     0     0     0     0     0
##    snp15 snp16 snp17 snp18 snp19 snp20 snp21 snp22 snp23 snp24 snp25 snp26
## 3      0     0     0     0     0     0     0     0     0     0     0     0
## 4      0     0     0     0     0     0     0     0     0     0     0     0
## 19     0     0     0     0     0     0     0     0     0     0     0     0
## 25     0     0     0     0     0     0     0     0     0     0     0     0
## 26     0     0     0     0     0     0     0     0     0     0     0     0
## 27     0     0     0     0     0     0     0     0     0     0     0     0
##    snp27 snp28 snp29 snp30 snp31 snp32 snp33 snp34 snp35 snp36 snp37 snp38
## 3      0     0     0     0     0     1     0     0     0     0     0     0
## 4      0     0     0     0     0     0     0     0     0     0     0     0
## 19     0     0     0     0     0     0     0     0     0     0     0     0
## 25     0     0     0     0     0     0     0     0     0     0     0     0
## 26     0     0     0     0     0     0     0     0     0     0     0     0
## 27     0     0     0     0     0     0     0     0     0     0     0     0
##    snp39 snp40 snp41 snp42 snp43 snp44 snp45 snp46 snp47 snp48 snp49 snp50
## 3      0     0     1     0     0     0     0     0     0     0     0     0
## 4      0     0     0     0     0     0     0     0     0     0     0     0
## 19     0     0     0     0     0     0     0     0     0     0     0     0
## 25     0     0     0     0     0     0     0     0     0     0     0     0
## 26     0     0     0     0     0     0     0     0     0     0     0     0
## 27     0     0     0     0     0     0     0     0     0     0     0     0
##    snp51 snp52 snp53 snp54 snp55 snp56 snp57
## 3      0     0     0     0     0     0     0
## 4      0     0     0     0     0     0     0
## 19     0     0     0     0     0     0     0
## 25     0     0     0     0     0     0     0
## 26     0     0     0     0     0     0     0
## 27     0     0     0     0     0     0     0</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="speciation-and-hybridization.html#cb46-1" aria-hidden="true" tabindex="-1"></a>submeta <span class="ot">&lt;-</span> ordermeta[<span class="fu">complete.cases</span>(genos),]</span>
<span id="cb46-2"><a href="speciation-and-hybridization.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(submeta)</span></code></pre></div>
<pre><code>##           ID          Reach    River Genetic.ID Field.ID Length Weight Age
## 1079  ILAG 3 LaGrange Reach Illinois      Bx4SV     SVCP    362    525   3
## 1080  ILAG 4 LaGrange Reach Illinois      Bx4SV     SVCP    371    600   1
## 1095 ILAG 19 LaGrange Reach Illinois         SV     SVCP    619   2550   4
## 1101 ILAG 25 LaGrange Reach Illinois         SV     SVCP    453   1050   2
## 1102 ILAG 26 LaGrange Reach Illinois         SV     SVCP    336    500   1
## 1103 ILAG 27 LaGrange Reach Illinois         SV     SVCP    364    600   1
##      Birth.year
## 1079       2006
## 1080       2008
## 1095       2005
## 1101       2007
## 1102       2008
## 1103       2008</code></pre>
<p>This works because we <em>know</em> that <code>genos</code> and <code>ordermeta</code> are in the same order. Now we can use this subsetted data to calculate a PCA and plot it:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="speciation-and-hybridization.html#cb48-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(subgen)</span>
<span id="cb48-2"><a href="speciation-and-hybridization.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x)</span></code></pre></div>
<p><img src="Website_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>This doesn’t really mean anything if we don’t categorize the dots. For now, let’s color them by “River”:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="speciation-and-hybridization.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x,<span class="at">col=</span>submeta<span class="sc">$</span>River,<span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb49-2"><a href="speciation-and-hybridization.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">levels</span>(submeta<span class="sc">$</span>River), <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nlevels</span>(submeta<span class="sc">$</span>River))</span></code></pre></div>
<p><img src="Website_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>As you can see, there doesn’t seem to be obvious separation by River. What do you think is driving the patterns you see in this PCA?</p>
<p> 
 
 </p>
</div>
<div id="homework-5" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Homework</h2>
<p>For homework we will continue using the data from Lamer et al. (2015).There are two relevant files:</p>
<p><a href="data/lamar_genotypes.csv">lamar_genotypes.csv</a> Has SNP genotypes for each individual</p>
<p><a href="data/lamar_metadata.csv">lamar_metadata.csv</a> contains information about location of sampling</p>
<p> </p>
<p>###<em>Homework 5: Write a script that does the following:</em></p>
<ol style="list-style-type: decimal">
<li><p>Read in the “lamar_genotypes.csv” and “lamar_metadata.csv.” Reorder the metadata so that samples in the same order as in the genotypes file.</p></li>
<li><p>Write a function that returns the proportion of data for each individual that is missing. Apply the function to your genotype data and print the summary.</p></li>
<li><p>Create a PCA. Color by Field.ID and add a legend.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="project-time.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="veterans-day.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Website.pdf", "Website.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
