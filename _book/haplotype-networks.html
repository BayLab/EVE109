<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 5 Haplotype networks | EVE 109: Molecular Ecology</title>
  <meta name="description" content="Tutorials and datasets for discussion and homeowork excesises for EVE 109: Molecular Ecology" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 5 Haplotype networks | EVE 109: Molecular Ecology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tutorials and datasets for discussion and homeowork excesises for EVE 109: Molecular Ecology" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 5 Haplotype networks | EVE 109: Molecular Ecology" />
  
  <meta name="twitter:description" content="Tutorials and datasets for discussion and homeowork excesises for EVE 109: Molecular Ecology" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="population-structure.html"/>

<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EVE109 FQ21</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#tour-of-rstudio"><i class="fa fa-check"></i><b>1.2</b> Tour of RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#basic-functions-in-r"><i class="fa fa-check"></i><b>1.4</b> Basic functions in R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#exercise-write-a-script-to-find-out-what-fraction-of-your-life-youve-been-at-uc-davis"><i class="fa fa-check"></i><b>1.4.1</b> <em>Exercise</em>: Write a script to find out what fraction of your life you’ve been at UC Davis</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#classes"><i class="fa fa-check"></i><b>1.5</b> Classes</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#vectors-and-dataframes"><i class="fa fa-check"></i><b>1.6</b> Vectors and dataframes</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#subsetting"><i class="fa fa-check"></i><b>1.7</b> Subsetting</a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#plotting"><i class="fa fa-check"></i><b>1.8</b> Plotting</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="index.html"><a href="index.html#exercise-describe-this-plot-in-plain-english.-what-conclusions-can-we-draw"><i class="fa fa-check"></i><b>1.8.1</b> <em>Exercise</em>: Describe this plot in plain english. What conclusions can we draw?</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#homework"><i class="fa fa-check"></i><b>1.9</b> Homework</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#homework-1-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>1.9.1</b> <em>Homework 1: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="molecular-markers.html"><a href="molecular-markers.html"><i class="fa fa-check"></i><b>2</b> Molecular Markers</a>
<ul>
<li class="chapter" data-level="2.1" data-path="molecular-markers.html"><a href="molecular-markers.html#paths"><i class="fa fa-check"></i><b>2.1</b> Paths</a></li>
<li class="chapter" data-level="2.2" data-path="molecular-markers.html"><a href="molecular-markers.html#reading-in-data-from-spreadsheets"><i class="fa fa-check"></i><b>2.2</b> Reading in data from spreadsheets</a></li>
<li class="chapter" data-level="2.3" data-path="molecular-markers.html"><a href="molecular-markers.html#simple-capture-recapture-example"><i class="fa fa-check"></i><b>2.3</b> Simple capture recapture example</a></li>
<li class="chapter" data-level="2.4" data-path="molecular-markers.html"><a href="molecular-markers.html#homework-1"><i class="fa fa-check"></i><b>2.4</b> Homework</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="molecular-markers.html"><a href="molecular-markers.html#homework-2-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>2.4.1</b> <em>Homework 2: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="genetic-diversity.html"><a href="genetic-diversity.html"><i class="fa fa-check"></i><b>3</b> Genetic Diversity</a>
<ul>
<li class="chapter" data-level="3.1" data-path="genetic-diversity.html"><a href="genetic-diversity.html#manipulating-dataframes"><i class="fa fa-check"></i><b>3.1</b> Manipulating dataframes</a></li>
<li class="chapter" data-level="3.2" data-path="genetic-diversity.html"><a href="genetic-diversity.html#using-the-adegenet-package-to-calulate-heterozygosity"><i class="fa fa-check"></i><b>3.2</b> Using the <strong>adegenet</strong> package to calulate heterozygosity</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="genetic-diversity.html"><a href="genetic-diversity.html#plotting-heterozygosity"><i class="fa fa-check"></i><b>3.2.1</b> Plotting heterozygosity</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="genetic-diversity.html"><a href="genetic-diversity.html#homework-2"><i class="fa fa-check"></i><b>3.3</b> Homework</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="genetic-diversity.html"><a href="genetic-diversity.html#homework-3-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>3.3.1</b> <em>Homework 3: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="population-structure.html"><a href="population-structure.html"><i class="fa fa-check"></i><b>4</b> Population Structure</a>
<ul>
<li class="chapter" data-level="4.1" data-path="population-structure.html"><a href="population-structure.html#the-aggregate-and-apply-functions"><i class="fa fa-check"></i><b>4.1</b> The <code>aggregate</code> and <code>apply</code> functions</a></li>
<li class="chapter" data-level="4.2" data-path="population-structure.html"><a href="population-structure.html#running-a-clustering-analysis-and-deciding-on-a-k-value"><i class="fa fa-check"></i><b>4.2</b> Running a clustering analysis and deciding on a K value</a></li>
<li class="chapter" data-level="4.3" data-path="population-structure.html"><a href="population-structure.html#the-q-matrix"><i class="fa fa-check"></i><b>4.3</b> The Q matrix</a></li>
<li class="chapter" data-level="4.4" data-path="population-structure.html"><a href="population-structure.html#plotting-1"><i class="fa fa-check"></i><b>4.4</b> Plotting</a></li>
<li class="chapter" data-level="4.5" data-path="population-structure.html"><a href="population-structure.html#homework-3"><i class="fa fa-check"></i><b>4.5</b> Homework</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="population-structure.html"><a href="population-structure.html#homework-4-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>4.5.1</b> <em>Homework 4: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="haplotype-networks.html"><a href="haplotype-networks.html"><i class="fa fa-check"></i><b>5</b> Haplotype networks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="haplotype-networks.html"><a href="haplotype-networks.html#indexing"><i class="fa fa-check"></i><b>5.1</b> Indexing</a></li>
<li class="chapter" data-level="5.2" data-path="haplotype-networks.html"><a href="haplotype-networks.html#using-table-to-count-across-multiple-columns"><i class="fa fa-check"></i><b>5.2</b> Using <code>table</code> to count across multiple columns</a></li>
<li class="chapter" data-level="5.3" data-path="haplotype-networks.html"><a href="haplotype-networks.html#creating-a-haplotype-network"><i class="fa fa-check"></i><b>5.3</b> Creating a haplotype network</a></li>
<li class="chapter" data-level="5.4" data-path="haplotype-networks.html"><a href="haplotype-networks.html#homework-4"><i class="fa fa-check"></i><b>5.4</b> Homework</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="haplotype-networks.html"><a href="haplotype-networks.html#homework-5-write-a-script-that-does-the-following"><i class="fa fa-check"></i><b>5.4.1</b> <em>Homework 5: Write a script that does the following:</em></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EVE 109: Molecular Ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="haplotype-networks" class="section level1" number="5">
<h1><span class="header-section-number">Week 5</span> Haplotype networks</h1>
<div id="indexing" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Indexing</h2>
<p>Today we’ll use the “Arthritis” dataset from the <code>vcd</code> package to learn some functions. Let’s install it:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="haplotype-networks.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;vcd&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="haplotype-networks.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb2-2"><a href="haplotype-networks.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Arthritis)</span>
<span id="cb2-3"><a href="haplotype-networks.html#cb2-3" aria-hidden="true" tabindex="-1"></a>?Arthritis</span>
<span id="cb2-4"><a href="haplotype-networks.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Arthritis)</span></code></pre></div>
<pre><code>##   ID Treatment  Sex Age Improved
## 1 57   Treated Male  27     Some
## 2 46   Treated Male  29     None
## 3 77   Treated Male  30     None
## 4 17   Treated Male  32   Marked
## 5 36   Treated Male  46   Marked
## 6 23   Treated Male  58   Marked</code></pre>
<p> </p>
<p>R and other programing languages use “indexing” to subset data. Indexing uses the order of entries (for example values in a vector or rows in a dataframe) to isolate particular entries. We’ve already used indexing to subset, maybe without even knowing it. For example, we know the command below gives us the <em>first</em> through <em>fourth</em> rows and the <em>first</em> through <em>third</em> columns. The numbers inside the brackes are called “indexes.”</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="haplotype-networks.html#cb4-1" aria-hidden="true" tabindex="-1"></a>Arthritis[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>##   ID Treatment  Sex
## 1 57   Treated Male
## 2 46   Treated Male
## 3 77   Treated Male
## 4 17   Treated Male</code></pre>
<p> </p>
<p>We can also use indexing to subet by a certain criteria. The command <code>which</code> returns indexes for all entries that meet a certain criteria. We saw a similar effect last week when we used <code>which.max</code>, but <code>which</code> is a more general command:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="haplotype-networks.html#cb6-1" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">which</span>(Arthritis<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&quot;Male&quot;</span>)</span>
<span id="cb6-2"><a href="haplotype-networks.html#cb6-2" aria-hidden="true" tabindex="-1"></a>ind</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 42 43 44 45 46 47 48 49 50 51 52</code></pre>
<p>This gives us the indexes of the rows in the Arthritis data frame where the patient was male. If we want to retrieve these rows, we can use that vector to pull out those rows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="haplotype-networks.html#cb8-1" aria-hidden="true" tabindex="-1"></a>Arthritis[ind,]</span></code></pre></div>
<pre><code>##    ID Treatment  Sex Age Improved
## 1  57   Treated Male  27     Some
## 2  46   Treated Male  29     None
## 3  77   Treated Male  30     None
## 4  17   Treated Male  32   Marked
## 5  36   Treated Male  46   Marked
## 6  23   Treated Male  58   Marked
## 7  75   Treated Male  59     None
## 8  39   Treated Male  59   Marked
## 9  33   Treated Male  63     None
## 10 55   Treated Male  63     None
## 11 30   Treated Male  64     None
## 12  5   Treated Male  64     Some
## 13 63   Treated Male  69     None
## 14 83   Treated Male  70   Marked
## 42  9   Placebo Male  37     None
## 43 14   Placebo Male  44     None
## 44 73   Placebo Male  50     None
## 45 74   Placebo Male  51     None
## 46 25   Placebo Male  52     None
## 47 18   Placebo Male  53     None
## 48 21   Placebo Male  59     None
## 49 52   Placebo Male  59     None
## 50 45   Placebo Male  62     None
## 51 41   Placebo Male  62     None
## 52  8   Placebo Male  63   Marked</code></pre>
<p>Note that we could have just as easily done this:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="haplotype-networks.html#cb10-1" aria-hidden="true" tabindex="-1"></a>Arthritis[Arthritis<span class="sc">$</span>Sex<span class="sc">==</span><span class="st">&quot;Male&quot;</span>,]</span></code></pre></div>
<p>When you do a command like this R finds the indexes and returns the rows for you, without you having to think about indexes. However, it can still be useful to know how indexes work, as we will see in the section today.</p>
<p> 
 
 </p>
</div>
<div id="using-table-to-count-across-multiple-columns" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Using <code>table</code> to count across multiple columns</h2>
<p>Previously we used the <code>table</code> function to count the number of times each value was observed in a specific column. Today we’ll use the same function to create a matrix of counts across two different variables. First let’s get some data. Install the package <code>vcd</code>, load the library and pull up the <strong>Arthritis</strong> dataset:</p>
<p>Notice that several of the columns are categorical. That means we can count how many times a certain category shows up.</p>
<p>Before, we made a table with just one column, like this:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="haplotype-networks.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Arthritis<span class="sc">$</span>Improved)</span></code></pre></div>
<pre><code>## 
##   None   Some Marked 
##     42     14     28</code></pre>
<p>But what if we want to sort by another factor simultaneously. For example, we can see improvement based on treatment:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="haplotype-networks.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Arthritis<span class="sc">$</span>Treatment,Arthritis<span class="sc">$</span>Improved)</span></code></pre></div>
<pre><code>##          
##           None Some Marked
##   Placebo   29    7      7
##   Treated   13    7     21</code></pre>
<p> 
 
 </p>
</div>
<div id="creating-a-haplotype-network" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Creating a haplotype network</h2>
<p>Today we will use mtDNA sequences from an example dataset to learn to create a haplotype network. The package we will use is called <code>pegas</code>. Install this package and load the library.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="haplotype-networks.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pegas&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="haplotype-networks.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pegas)</span></code></pre></div>
<p>We will take advantage of a dataset called <code>woodmouse</code> that is part of the <code>pegas</code> package:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="haplotype-networks.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(woodmouse)</span>
<span id="cb17-2"><a href="haplotype-networks.html#cb17-2" aria-hidden="true" tabindex="-1"></a>woodmouse</span></code></pre></div>
<pre><code>## 15 DNA sequences in binary format stored in a matrix.
## 
## All sequences of same length: 965 
## 
## Labels:
## No305
## No304
## No306
## No0906S
## No0908S
## No0909S
## ...
## 
## Base composition:
##     a     c     g     t 
## 0.307 0.261 0.126 0.306 
## (Total: 14.47 kb)</code></pre>
<p>Notice that woodmouse only has 15 individuals. We want to work with a few more, so we will artificially expand the dataset. We can do this by sampling with replacement using the command <code>sample</code>. Here we create a vector of the numbers 1:15, randomly sampled 100 times. We use that to choose individuals to sample (some multiple times) from the woodmouse dataset:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="haplotype-networks.html#cb19-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> woodmouse[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,<span class="at">size=</span><span class="dv">100</span>,<span class="at">replace=</span>T),]</span>
<span id="cb19-2"><a href="haplotype-networks.html#cb19-2" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
<pre><code>## 100 DNA sequences in binary format stored in a matrix.
## 
## All sequences of same length: 965 
## 
## Labels:
## No1208S
## No304
## No0910S
## No0913S
## No1208S
## No1007S
## ...
## 
## Base composition:
##     a     c     g     t 
## 0.307 0.261 0.126 0.306 
## (Total: 96.5 kb)</code></pre>
<p> </p>
<p>Now we have 100 individuals! First, let’s make up some metadata that we can use later. You can use the <code>labels</code> function to pull sample names out of <code>data</code>. We will also assign each sample to a random “north” or “south” location.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="haplotype-networks.html#cb21-1" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;north&quot;</span>,<span class="st">&quot;south&quot;</span>),<span class="dv">100</span>,<span class="at">replace=</span>T)</span>
<span id="cb21-2"><a href="haplotype-networks.html#cb21-2" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">labels</span>(data)</span>
<span id="cb21-3"><a href="haplotype-networks.html#cb21-3" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(names,loc))</span>
<span id="cb21-4"><a href="haplotype-networks.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meta)</span></code></pre></div>
<pre><code>##     names   loc
## 1 No1208S south
## 2   No304 north
## 3 No0910S south
## 4 No0913S north
## 5 No1208S south
## 6 No1007S north</code></pre>
<p>NOTE: If we were doing this on real data, we would usually read in the populations from a spreadsheet. Here we just make them up to illustrate how the process works!</p>
<p> </p>
<p>When we sequence DNA, some individuals will have the same haplotype. So the first step is to check how many haplotypes there are and which individuals share haplotypes. We do this with the <code>haplotype</code> function:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="haplotype-networks.html#cb23-1" aria-hidden="true" tabindex="-1"></a>hap <span class="ot">&lt;-</span> <span class="fu">haplotype</span>(data)</span>
<span id="cb23-2"><a href="haplotype-networks.html#cb23-2" aria-hidden="true" tabindex="-1"></a>hap</span></code></pre></div>
<pre><code>## 
## Haplotypes extracted from: data 
## 
##     Number of haplotypes: 15 
##          Sequence length: 965 
## 
## Haplotype labels and frequencies:
## 
##    I   II  III   IV    V   VI  VII VIII   IX    X   XI  XII XIII  XIV   XV 
##    8    6   10    4    6   10    6   13    2    4    6    5    6    6    8</code></pre>
<p> </p>
<p>In the output you can see the frequencies of each of the 15 haplotypes. Now we want a list of which individuals have which haplotypes:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="haplotype-networks.html#cb25-1" aria-hidden="true" tabindex="-1"></a>hapInfo <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="fu">setNames</span>(<span class="fu">attr</span>(hap,<span class="st">&quot;index&quot;</span>),<span class="fu">rownames</span>(hap)))</span>
<span id="cb25-2"><a href="haplotype-networks.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hapInfo)</span></code></pre></div>
<pre><code>##   values ind
## 1      1   I
## 2      5   I
## 3     38   I
## 4     58   I
## 5     68   I
## 6     79   I</code></pre>
<p>This command is a bit complicated. Briefly, it takes a list of individuals for each haplotype, and makes a dataframe that tells you which individual has which haplotype. The tricky part is that it returns the <em>indexes</em> of the individuals, not their actual data. Let’s change the column names to make more sense:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="haplotype-networks.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(hapInfo) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;index&quot;</span>,<span class="st">&quot;haplotype&quot;</span>)</span></code></pre></div>
<p> </p>
<p>Now, we can use that index to merge the <code>meta</code> dataframe with the <code>hapInfo</code> data frame:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="haplotype-networks.html#cb28-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(hapInfo,meta[hapInfo<span class="sc">$</span>index,]))</span>
<span id="cb28-2"><a href="haplotype-networks.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(merged)</span></code></pre></div>
<pre><code>##    index haplotype   names   loc
## 1      1         I No1208S south
## 5      5         I No1208S south
## 38    38         I No1208S north
## 58    58         I No1208S north
## 68    68         I No1208S south
## 79    79         I No1208S north</code></pre>
<p> </p>
<p>Great! Now lets start to make a haplotype network! This is pretty simple in <code>pegas</code> using the <code>haploNet</code> function. Below we plot the network for out haplotype set <code>hap</code>. We use the “freq” attribute to size the circles so that each circle is proportional to the number of samples with that haplotype:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="haplotype-networks.html#cb30-1" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">haploNet</span>(hap)</span>
<span id="cb30-2"><a href="haplotype-networks.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(net,<span class="at">size=</span><span class="fu">attr</span>(net,<span class="st">&quot;freq&quot;</span>))</span></code></pre></div>
<p><img src="Website_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Cool, now we want to add colors. Take a look at the <code>haploNet</code> help page, paying particular attention to the <code>pie</code> argument:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="haplotype-networks.html#cb31-1" aria-hidden="true" tabindex="-1"></a>?haploNet</span></code></pre></div>
<p> </p>
<p>So what we need is a matrix where <em>rows</em> are the different haplotypes and <em>columns</em> are the different locations. We can use the <code>merged</code> dataframe we made above along with the <code>table</code> command to produce this matrix:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="haplotype-networks.html#cb32-1" aria-hidden="true" tabindex="-1"></a>pie <span class="ot">&lt;-</span> <span class="fu">table</span>(merged<span class="sc">$</span>haplotype,merged<span class="sc">$</span>loc)</span>
<span id="cb32-2"><a href="haplotype-networks.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pie)</span></code></pre></div>
<pre><code>##      
##       north south
##   I       5     3
##   II      4     2
##   III     3     7
##   IV      3     1
##   V       4     2
##   VI      5     5</code></pre>
<p>This table shows, for each haplotype, how many individuals come from the north and how many come from the south. Remember, this is completely made up data so we don’t expect any pattern here. Now we can use this to color the circles in the haplotype network, including adding a legend:</p>
<p> </p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="haplotype-networks.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(net,<span class="at">size=</span><span class="fu">attr</span>(net,<span class="st">&quot;freq&quot;</span>),<span class="at">pie=</span>pie)</span>
<span id="cb34-2"><a href="haplotype-networks.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="fu">colnames</span>(pie), <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">ncol</span>(pie)), <span class="at">pch=</span><span class="dv">19</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Website_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="homework-4" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Homework</h2>
<p> 
For homework you will create a haplotype network using the mtDNA data from Cliff et al. (2015). Here are the files you will need:
<a href="data/cliff_metadata.csv"><strong>cliff_metadata.csv</strong></a> contains sample IDs along with population information and haplotype inferred within the paper
<a href="data/cliff_mtDNA.fasta"><strong>cliff_mtDNA.fasta</strong></a> contains mtDNA sequences from the paper.
 </p>
<div id="homework-5-write-a-script-that-does-the-following" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> <em>Homework 5: Write a script that does the following:</em></h3>
<ol style="list-style-type: decimal">
<li><p>Read in the fasta file “mtDNA.fa” and the metadata file “metadata.csv” (hint: to read the .fa file you will use the command read.dna with argument format=“fasta”)</p></li>
<li><p>Create a haplotype network (no colors)</p></li>
<li><p>Create a table that shows the number of each haplotype in each population</p></li>
<li><p>Create a haplotype network (with colors)</p></li>
<li><p>Add a legend (this might look messy - that’s okay)</p></li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="population-structure.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Website.pdf", "Website.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
